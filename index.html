<html>

<head></head>

<body>
    <script>
        var data = [[0, null], [1, 2], [2, 3], [3, null], [4, null], [5, 10], [6, null], [7, null]];

        data = dataAccumToPercent(data);

        console.log(data);
        function dataAccumToPercent(data) {
            if (!(data && data.length > 0)) return;

            // fill all null
            // for(var i =0;i<data.length;i++){
            var i = 0;
            while (i < data.length) {
                if (data[i][1]) {
                    i++;
                    continue;
                }
                if (i > 0 && data[i - 1][1]) {
                    var prev = data[i - 1];
                    for (var j = i + 1; j < data.length; j++) {
                        if (data[j][1])
                            break;
                    }
                    if (j == data.length) {
                        data = data.slice(0, i);
                        break;
                    }

                    var next = data[j];
                    for (var k = i; k < j; k++) {
                        data[k][1] = (next[1] - prev[1]) * (k - (i - 1)) / (j - (i - 1)) + prev[1];
                    }
                    i = j + 1;
                } else {  // i ==0
                    var kk = i + 1;
                    while (kk < data.length && !data[kk][1]) {
                        kk++;
                    }
                    if (kk >= data.length - 1) {
                        data = [];
                        break;
                    }
                    prev = data[kk];
                    kk++;
                    while (kk < data.length && !data[kk][1]) {
                        kk++;
                    }
                    if (kk >= data.length - 1) {
                        data = [];
                        break;
                    }
                    next = data[kk];
                    data[i][1] = next[1] - prev[1] * (next[0] - prev[0]) / (prev[0] - data[i][0]);

                    i++;
                }
            }

            return data;

        }
    </script>

</body>

</html>
